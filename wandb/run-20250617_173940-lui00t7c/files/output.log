  0%|                                                                                            | 0/985 [00:00<?, ?it/s]/Users/andreagrandi/Developer/resnet_classifier/.venv/lib/python3.10/site-packages/torch/utils/data/dataloader.py:683: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, then device pinned memory won't be used.
  warnings.warn(warn_msg)
 60%|█████████████████████████████████████████████████▏                                | 591/985 [05:26<02:18,  2.85it/s]/Users/andreagrandi/Developer/resnet_classifier/.venv/lib/python3.10/site-packages/torch/utils/data/dataloader.py:683: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, then device pinned memory won't be used.
{'loss': 3.5449, 'grad_norm': 35.35771179199219, 'learning_rate': 2.467005076142132e-05, 'epoch': 2.54}
  warnings.warn(warn_msg)                                                                                                
{'eval_loss': 1.6262882947921753, 'eval_accuracy': 0.7411167512690355, 'eval_runtime': 18.6629, 'eval_samples_per_second': 21.111, 'eval_steps_per_second': 2.679, 'epoch': 2.54}
100%|██████████████████████████████████████████████████████████████████████████████████| 985/985 [08:41<00:00,  1.89it/s]
{'train_runtime': 522.9253, 'train_samples_per_second': 15.031, 'train_steps_per_second': 1.884, 'train_loss': 2.1696160485901808, 'epoch': 5.0}
Evaluating model...
/Users/andreagrandi/Developer/resnet_classifier/.venv/lib/python3.10/site-packages/torch/utils/data/dataloader.py:683: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, then device pinned memory won't be used.
  warnings.warn(warn_msg)
100%|████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:16<00:00,  2.98it/s]
 eval_loss: 1.1386786699295044
 eval_accuracy: 0.8350253807106599
 eval_runtime: 17.4291
 eval_samples_per_second: 22.606
 eval_steps_per_second: 2.869
 epoch: 5.0
Saving final model to ./out...
Training failed with error: name 'training_info' is not defined
